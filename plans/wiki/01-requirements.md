# KotaServer Wiki - 要件定義

## 概要

KotaServerウェブサイトにWiki機能を追加する。運営者と承認された編集者が独自の管理画面からコンテンツを管理できる総合的なWikiシステムを構築する。

---

## コンテンツ要件

### 対象コンテンツ

総合的なWikiとして、以下のコンテンツを掲載予定：

- サーバールール
- 参加方法
- よくある質問（FAQ）
- 遊び方ガイド
- MOD/プラグインの使い方
- コマンド一覧
- 建築物紹介
- イベント情報
- コミュニティの歴史

---

## ユーザー要件

### ユーザーロール

| ロール | 説明 | 作成方法 |
|--------|------|----------|
| 管理者（admin） | 全権限を持つ。他ユーザーの権限変更、編集者の招待が可能 | データベース直接変更のみ |
| モデレーター（moderator） | 編集者の招待が可能 | 管理者が権限を付与 |
| 編集者（editor） | 記事の作成・編集が可能 | 管理者またはモデレーターが招待 |

### 権限マトリクス

| 操作 | 管理者 | モデレーター | 編集者 |
|------|:------:|:------------:|:------:|
| 記事の作成・編集・削除 | ✓ | ✓ | ✓ |
| 記事の公開・非公開 | ✓ | ✓ | ✓ |
| カテゴリの管理 | ✓ | ✓ | - |
| 編集者の招待 | ✓ | ✓ | - |
| ユーザー権限の変更 | ✓ | - | - |
| サイトの再デプロイ | ✓ | ✓ | - |

### 認証方式

- ユーザー名とパスワードによるシンプルな認証

---

## 機能要件

### 記事管理

| 機能 | 詳細 |
|------|------|
| エディタ | Markdownエディタ（リアルタイムプレビュー付き） |
| 画像アップロード | 記事内に画像を挿入可能 |
| バージョン管理 | 編集履歴の保存と差分表示 |
| 公開状態管理 | 下書き保存、公開/非公開の切り替え |

### カテゴリ管理

| 機能 | 詳細 |
|------|------|
| フラット構造 | 複数のカテゴリが並列に存在（階層なし） |
| 並び順 | カテゴリの表示順を設定可能 |
| サイドメニュー | すべてのカテゴリと記事がサイドメニューに表示される |

### 検索機能

| 機能 | 詳細 |
|------|------|
| 全文検索 | タイトルと本文を対象とした検索 |

### デプロイ機能

| 機能 | 詳細 |
|------|------|
| 自動デプロイ | 記事公開時に公開サイトの再ビルドを自動トリガー |

---

## URL設計

### 公開Wiki

| ページ | URL |
|--------|-----|
| Wiki トップ | `/wiki` |
| 記事ページ | `/wiki/{記事スラッグ}` |
| 検索結果 | `/wiki/search?q={検索クエリ}` |

※ カテゴリ一覧ページは設けず、サイドメニューですべてのカテゴリ・記事を表示

### 管理画面

別ドメインまたはサブドメインで運用（例: `admin.kotaserver.com`）

---

## 非機能要件

### パフォーマンス

- 公開Wikiは静的生成（SSG）で高速表示
- 画像は適切なサイズに最適化

### セキュリティ

- 管理画面へのアクセスは認証必須
- パスワードは適切にハッシュ化して保存
- セッション管理の適切な実装

### 可用性

- Cloudflareのエッジネットワークを活用した高可用性

---

## 制約事項

- 日本語コンテンツが主体
- 既存のAstroプロジェクトとの統合が必要
- Cloudflareエコシステム内での構築
